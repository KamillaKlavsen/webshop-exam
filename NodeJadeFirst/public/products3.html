<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/global.css">
    <!-- <link rel="stylesheet" href="/css/index.css"> -->
    <link rel="stylesheet" href="/css/products.css">
    <link rel="stylesheet" href="/css/nav.css">
    <script src="https://use.fontawesome.com/releases/v5.13.0/js/all.js" data-auto-replace-svg="nest"></script>
    <!-- <link rel="stylesheet" href="/css/products.css"> -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Lora&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Mulish:wght@200&display=swap');
    </style>
    <title>Sketchy Sneaks</title>
<script type="text/javascript">
    var content;
    var product;
    var productinfo;
    var product_arr = [];

    //fetch request a new page (kinda like routing)
    const updatepage = page => {
        fetch(`http://localhost:2000/product?page=${page}`)
                .then(response => response.json())
                .then(json => {
                    product_arr = json.data;
                    updatelist(json.data);
                })
    };

    const updatelist = productarr => {
        let str = '';
        // product_arr[0].Name
        console.log(product_arr[0].Name);

        for (let i = 0; i < 4; i++) {
            str += `<div class="product">
                <div>
                    <img src="images/${product_arr[i].ImageFile}" class="product-img">
                    <h3 class="product-brand">${product_arr[i].Brand}</h3> 
                    <h4 class="product-name">${product_arr[i].Name}</h4> 
                   <p class="product-price">${product_arr[i].Price}</p>
                   <a href="/productdetail.html#${product_arr[i].ProductId}">click here</a>
                  
                   </div>
                   </div>
                   
                   `
                ;
            console.log(product_arr[i].Name);
        }

        product.innerHTML = str;

    };

    const getproduct = id => {
            let product = `product${id}`;
            fetch(product)
            .then(response => response.json())
            .then(json => {
               productinfo.innerHTML = `name:${product.name} is ${product.price}`
              
            })

        };

    const onproductclicked = e => {
            e.preventDefault();
            if (e.target.nodeName === 'A') {
                let id = e.target.getAttribute('href');
                console.log(id);
            }
        }

    document.addEventListener('DOMContentLoaded', e => {
        content = document.getElementById('content');
        product = document.getElementById('product');

        console.log(content);

        // product.addEventListener('click', onproductclicked);

        let event = new Event('hashchange');
        window.dispatchEvent(event);

        // fetch('http://localhost:2000/product')
        //         .then(response => response.json())
        //         .then(json => {
        //             product_arr = json.data;
        //             updatelist(json.data);
        //         })
    });

    window.addEventListener('hashchange', e => {
        let page = window.location.hash.substring(1);
        page = (page.length > 0)?page:1; //
        updatepage(page); //updates the id in the URL
    }); //det kan udkommenteres (for at f√• til at du igen)
</script>

</head>

<body>
    <ul>
        <li><a href="#1">Page 1</a></li>
        <li><a href="#2">Page 2</a></li>
        <li><a href="#3">Page 3</a></li>
    </ul>
    <div id="content"></div>
    <div id="product"></div>

</body>

</html>